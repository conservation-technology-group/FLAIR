# Code for plotting tailbeat frequency over time from a series of shark masks (Figure 8)

import numpy as np
import matplotlib.pyplot as plt
from utils.photogrammetry import pixels_to_meters
from utils.stats import percent_error, mean_absolute_error
import seaborn as sns
from matplotlib.ticker import FormatStrFormatter

# following numbers are the output from tbf.py
blacktip_raw_pix = [28.51027272194324, 30.068537626850066, 22.28527619313522, 14.471651662615296, 16.52488537307867, 11.0, 2.8368019415310615, 5.550825887753518, 14.516985629853126, 4.310179667522941, -2.118324624683319, -4.311429302470189, -6.6538398617385575, -9.249159216758818, -6.539108227196948, -6.706941769246266, -7.031085285944733, -7.474093186836588, -10.84590537328887, -18.83267014652596, -16.956700828000013, -15.973941350783576, -16.717477662791786, -15.173122631337472, -14.33466103596113, -13.445583777051322, -6.090749332061066, -9.0, -2.601763454527975, 3.5941368039263644, 8.092633839701511, 15.332567830889563, 12.238957439582832, 14.12823869818427, 15.159591272431067, 17.477902553333024, 17.759423254076268, 20.224811989343678, 21.778518485041975, 23.790806988463288, 19.240525738667003, 43.202472194341965, 32.79498919647985, 23.4583632555606, 24.40780917834056, 27.582766155047647, 28.979802654074053, 20.248507655649178, 29.899272909656254, 26.708043500579826, 15.980159081081652, 19.324787367271366, 18.26228917678502, 17.39288578723139, 15.664023871139081, 16.99411662899845, 21.659614101704886, 9.391485505499091, 12.729239281211685, 2.5823779730500505, 2.1111932931543604, -3.4523940700586424, -9.602319269272602, -11.921041348294334, -11.702717985469164, -7.420176976943867, -10.168442613633973, -9.746162045117838, -13.284947634123512, -7.387367764195627, -4.47213595499958, -0.4757112906842884, 2.4392872420829774, -3.468563128972545, -3.204496624606302, -2.84296926237411, -2.7128495728570887, -1.9950590368708476, 5.226880903144737, 14.630665801596438, 20.588035844077275, 20.61987908727688, 23.054170368413757, 25.769403876803313, 21.68424700125308, 19.64411576396165, 28.329599666918458, 33.02692473604697, 33.59753165257783, 31.849424121577457, 31.273267101288138, 28.17594253113515, 31.125878096097864, 30.473979359938134, 27.444269337387826, 30.524833780685483, 16.664261014291377, 5.6923321331319965, 3.9219921560235624, 15.90527059830233, 5.146518265355115, 10.411930747310656, 10.414367979031875, 2.499794568387879, 4.820863894807399, -4.732660822705366, -5.968688631666305, -9.838946998982165, -9.661747821292872, -13.274769760531534, -13.341812006040275, -9.686488233546907, -12.665931411545866, -22.69981340589427, -25.396189536090247, -22.347775659404604, -17.376027900790916, -18.729149364032747, -11.120353549559587, -7.561693625793776, -8.48528137423857, -5.415224188089577, 9.398715287559474, 8.747691908597563, 13.010272901357215, 26.11722526585457, 29.75862068965521, 28.39242315887754, 27.932141739327324, 27.820235751002894, 33.05028620690891, 39.47841804119801, -6.659125246200634, 38.3100988495927, 40.411028535799964, 39.43523267385623, 42.58112147940852, 43.908661660949114, 44.648775846423575, 38.61945086403525, 42.91043647399292, 41.08579098859423, 42.591170525021376, 31.88912231640442, 25.603894862383065, 15.981682705873009, 21.843301431885635, 18.606412716227698, 17.77684890179706, 12.254517948971396, 4.558653070169415, -4.181641080401002, -8.481992596416735, -9.829528273499681, -15.4, -26.883576898663776, -30.70392851144172, -29.745984700917575, -23.228001142206015, -29.33210028871305, -39.83456354511985, -40.37846934737838, -41.84002777877066, -40.30621985138964, -42.936013118289, -39.25402463817529, -34.947374016349094, -5.690867558185308, -21.726354566715056, -13.406081832439812, -16.47861229105559, -8.517069886855674, -7.508457147035998, 10.461413693693059, 7.124510991852905, 35.33809030317245, 34.66713580398402, 35.88232917855163, 35.411353789569695, 39.01293555055157, 37.09323473021487, 35.04158696881508, 39.5318203613098, 37.469199604971536, 29.824364802382135, 20.269682298566146, 15.79022985983327, 7.6704842796171935, 3.5749130075562214, -4.181374459441535, -18.883615081445427, -25.416721559530963, -28.85214203659437, -44.11079988470247, -49.34723773737875, -58.3388715184317, -59.525635967167034, -55.473779246079516, -48.4736718176064, -51.69570664243325, -64.816152725819, -54.661964690858625, -60.89335647047634, -72.5829539071052, -64.30881558834868, -33.23401871576773, -61.71547617899424, -58.9661947163693, -36.21846356481023, -15.38822925671087, -0.6248759411034245, 1.1547862908979076, -12.890900775820619, -7.317445081594963, -4.250406093647666, 1.7783621331533268, 10.488945556147604, 45.10804124117321, 42.79962546268135, 42.560471926362595, 39.753198308170546, 11.463257624183361, 13.841084606328646, 11.08412788392368, 20.760688940418625, 21.908566705356233, 1.8018960203887133, -9.95602697656497, -18.839631546125894, -18.865191735073726, -25.883040702650227, -40.28774610666833, -48.68115987360736, -46.0926420414679, -42.62233241023564, -39.902181385271376, -53.96365661530098, -65.04563017634457, -53.14784902965585, -36.98238403111051, -29.466526883351058, -33.96997550291711, -32.98765941003449, -0.18958473932470266, 8.241379310344827, 22.18924039969358, 0.6732442278759793, 4.377427943810652, 9.443414353154571, 15.652956279045751, 28.686365633532755, 51.39076913625981, 63.03779329898283, 62.828759099166, 54.0654483310607, 59.302445565538264, 63.25845145537822, 64.87126295284989, 49.47777012059857, 45.94648960535291, 51.75521481801502, 46.591552218287674, 40.29389533304634, 33.031196482734074, -2.518609979019158, 9.938285401849999, -26.56243919559704, -31.041211862139445, -36.250763241423, -29.615099393541257, -37.65642192866229, -52.74010884362202, -59.9905212807636, -51.492135809741995, -59.94125671678773, -63.892553186493764, -69.10843737663052, -59.81624955149932, -35.77908356730174, -38.66551792760003, -32.36145025523927, -10.8774169964261, -17.413015670873808, 7.704669130201516, 25.435988998372274, 35.427708075522304, 32.644644958710444, 80.98622864888343, 43.448520855111255, 47.70716454434421, 87.39164470361759, 85.28363677695125, 79.26176156520047, 88.20689489515105, 55.53915356818719, 41.311816195897045, 43.90514461311716, 23.50751788984131, 56.65037756900251, 44.407272854262786, 5.260767593771401, -5.1933644356862905, -34.32327098566209, -34.13584572414675, 5.257978071290483, -6.56289883418948, -40.69085065180744, -45.24003492975608, -56.94170783362576, -59.2937348480499, -65.58191253369677, -58.270825130568696, -51.49599107297648, -48.2663154278477, -52.35217367088087, -47.242078330710164, -23.269238800063064, -1.4224952388018637, 14.971947328215808, 19.46420015481538, 11.43414924744546, 79.8006789412624, 83.11258696084715, 94.48548305211851, 92.21514211112914, 91.6411198125357, 89.03716564682249, 91.72535865352805, 101.00552587752944, 32.654428578548725, 32.854387800471265, 68.55812366363467, 69.63549166061108, 79.77758660667808, 77.21881139044503, 81.22754578931824, 85.38329958378658, -17.5923131072556, -37.60855679758622, -34.99874324494124, -40.17668067676211, -46.700776093685306, -49.872916198689246, -59.49239668856556, -53.41693860533965, -40.514659362828425, -51.89752964919185, -54.76277446032662, -11.781405466624008, -11.66212386378069, -8.619458188850961, -1.7879243822582334, -23.069983160327244, -19.595768407043316, -16.751274628371277, -14.564225397384318, 63.40314692258133, 65.75883001798853, 79.92891771240153, 94.5862068965517, 96.76939102264559, 98.25171993254921, -38.21190332149872, 33.063762429028294, 37.398993380602526, 23.740678263288494, 35.11741875183465, 12.046846429966807, -4.013213469645128, -12.825854523980194, -14.298957199430625, -24.367732280290067, -28.885275212252893, -36.76955262170047, -41.25139053990451, -50.400202220022564, -49.470829743323435, -50.58743965743759, -49.91826719760444, -26.732564458296743, -14.251085650370172, -10.49628337524936, 2.082255123821533, -24.043417778059638, -95.25760264216535, -88.24420023878129, -5.380268746819532, 25.63241384655019, 9.224540520047844, 15.518358354371726, 24.162128173162444, 26.351488075392098, 22.070890699741707, 26.23719199728582, 25.840234759848784, 28.419355211819436, 32.01520449885521, 29.66010944654311, 120.63941157340808, 140.98694770463146, 43.13711639424704, 26.827859885609556, 30.49346671329987, 26.239175481003414, 68.29633504464923, 45.85662776067158, 4.813619615316939, 32.09050862789946, 24.98203271852632, -15.159779699380875, -23.162989007130978, -36.64754354129425, -43.87234356576627, -26.297392134546424, -50.23425759981695, -34.514161109219685, -57.41192864926047, -23.706534737321842, -11.817087259619374, 2.682048557235578, 3.670747543463026, 13.431524533642628, -2.613925999136382, 12.231042205153585, 7.860938572305612, 54.33438496865038, 53.90799510252809, 57.1633871476199, 61.52701408326596, 85.87183267804302, 78.5769542439893, 77.35686546913287, 73.3168470295364, 68.85638497422197, 66.97320573024008, 57.741854092946205, 15.415996275832155, 10.752153182810755, 12.348705937921457, 11.98350092326819, 5.841248727608052, -6.089450256084361, -2.4007840575185146, -11.660407346283144, -21.552460135373682, -21.278231960315008, -23.38734528012242, -29.564516400930277, -32.27680544822677, -43.3061951996113, -46.06777893294505, -52.064635809540114, -22.63906167087112, -20.859224636203738, -13.104755814211364, 7.3690758368010165, 10.430699519509506, 38.42547024978826, 55.66231735882341, 67.19576787623015, 101.73583854246434, 87.45290922720702, 105.63806206523594, 99.64261021685307, 105.60156892621669, 112.74508884805385, 115.85307165107662, 117.83931589684065, 117.82685848695185, 125.43683792129134, 133.82018914358687, 125.73569287983376, 127.00866112198806, 123.97451711723613, 107.72624746922772, 101.59470044637445, 105.97592266360653, 78.33479973042871, 60.40986255446093, 43.756421131576815, 25.26314819191105, 1.8119506738251894, -18.773852163391076, -33.69966257132784, -35.812781509365315, -61.588163957064474, -59.434903062164, -49.620674444352346, -59.99126222780844, -63.05732918026827, -64.22971256206772, -118.97706612732598, -69.36347541168068, -76.85987434321126, -88.43457213354912, -78.23911212655337, -60.240703416042166, -38.88089682518959, -25.314767453709106, -12.02148161567818, -15.518909206305125, -5.969905830470118, 22.4749618881843, 44.761130722194785, 48.29835016349171, 62.88924649604866, 67.20170082539987, 54.55087977344143, 56.400387805141705, 62.2297939613985, 69.33437355429429, 78.63079660503556, 73.78327378257315, 66.20685289985533, 67.12714175591064, 63.43841641853361, 60.78750511136594, 42.252498553319505, 34.60914686977817, 24.962658032126306, 16.683966021557364, -6.704484580716466, -3.5212133131677215, -6.227211836036771, -19.692793887863957, -25.691438405562614, -34.33098955207046, -54.11284505549496, -47.798025273145974, -52.42861876623696, -52.12403635334993, -55.8083220258364, -51.23210761158846, -56.19580784719719, -61.694566021302045, -66.46803743153549, -35.50506427315821, -41.122190286717185, -47.64018141491381, -16.95339490873066, -5.746857278113895, -0.7482605453591644, 14.090504754861358, 25.61180602117658, 30.469919673129876, 41.37556670959853, 36.12477940462368, 59.37981961255396, 62.886712085845765, 96.11460136432797, 90.11270981777659, 87.75875398761185, 97.50701760842213, 104.81073496185005, 77.61036881088953]

blacktip_smooth_pix = [29.43929133425913, 25.70475976740525, 22.127898530171603, 18.708707622558187, 15.447187044565004, 12.343336796192052, 9.397156877439336, 6.608647288306885, 3.61507897970842, 1.5618583058638418, -0.4165593256236478, -2.4066674222954494, -3.24659862738614, -4.764574437231866, -7.257511746904145, -9.414604603817887, -10.196404265845805, -11.225729171119333, -12.450131615306656, -14.01304811920566, -14.844182056772933, -15.970766042537006, -16.445968651366634, -16.035676750843315, -14.7950428321015, -11.74408683589106, -8.058509651408993, -4.643379666620877, -1.0036407658644433, 2.853859603508077, 6.316472034124846, 9.547883969840381, 12.293857502102941, 14.873104137190513, 15.623954819872209, 17.23078676949971, 19.624653177304197, 21.616186143700432, 23.109884930744713, 24.955274768500367, 26.89921357987575, 27.45900300863169, 28.06288345417559, 29.169939521066212, 28.947568946425587, 28.24119725726816, 27.023940509573418, 25.506097230210678, 22.65586034986989, 21.987401113239255, 22.075187395919627, 20.63862776990859, 19.74373562800359, 18.5889259678475, 17.701514832058777, 15.731212885366254, 14.212896263220971, 12.065471438733852, 8.10434336071259, 4.548607021966555, 0.8716258103545654, -2.410242938919152, -6.1036684562035886, -9.083029948066429, -10.480412711302748, -11.775903746892013, -10.7578112491528, -9.756754987012297, -8.058313500829728, -6.31386279544242, -5.021550866716403, -4.5475607718380795, -4.517009105463823, -3.70910859131946, -2.237534456336004, -0.2958724689147676, 1.4446402205027198, 4.361274601969552, 7.75665902285919, 10.864544208598888, 14.416792805234923, 17.722939680477953, 21.103535786311788, 24.0713929661379, 26.449123081470354, 27.4102999439681, 28.05894891159089, 29.0824669659681, 29.889014015728684, 31.377486177735307, 32.77382172641905, 33.045039474996955, 30.540550433965734, 27.73720184735742, 24.251458844686688, 21.011663223245005, 18.528897963024153, 15.542562557074067, 13.336624879141043, 10.613193304707963, 8.41040870926701, 6.2521097391459435, 4.407605828941734, 3.3902644637302455, 1.1931553993616217, -1.7696144370011084, -4.50680607612269, -6.192284161874367, -9.376358245745934, -12.250571559486055, -14.150877776811846, -16.63401745869801, -17.89435069590242, -18.748522105003627, -19.00393847995762, -19.734846458914603, -18.720497112186777, -17.031294226451607, -14.994350536061756, -10.898138142072536, -5.169556811432539, 0.4841561758223142, 5.883890689452289, 10.775795920989466, 15.402155981476696, 22.8569656026747, 24.617460431755426, 26.270159149214788, 27.361616232916685, 27.591268207447598, 28.701085820019323, 29.374500221304277, 30.450849596892393, 32.0745746841809, 34.39563227006027, 36.50640323112583, 39.274974179045905, 41.64437216742756, 44.17566737135823, 45.79812816144509, 40.86941765528793, 38.25453701802628, 35.53085621591198, 32.44838126544363, 29.378582282282565, 25.799761854440263, 21.6944990585259, 16.875365160150466, 12.890269190564101, 8.494933011472668, 4.079681688902326, -1.6163886161239682, -6.875936354010392, -12.19427899302596, -16.991262279647078, -21.537880382587744, -25.4841215345858, -28.61241422705973, -31.723096625392504, -34.88081604040069, -39.25448058741805, -39.569559330663935, -39.20217617420029, -37.99827731566331, -36.757810187117386, -34.248079370736555, -30.96426639110119, -25.792846710635693, -22.54063350334264, -17.26802487479682, -10.996822599235866, -3.9133513213528968, 2.5053267539183843, 8.847227281784884, 14.636842705580815, 22.386658833121768, 28.169278590026998, 33.98699185156783, 38.051764781284106, 40.34352614375116, 40.17288985419853, 38.98425637969118, 35.08987638602408, 32.697964973608116, 28.640233743630162, 23.013963344908817, 16.855403889283608, 9.673032415905443, 1.6561127921714813, -7.641505862027948, -17.047799402892515, -26.238638857892763, -34.152496117239664, -40.35493238249717, -46.55516716051554, -51.0778724059426, -53.334141498047146, -55.62222778592466, -59.9340488937772, -59.693395665632806, -58.723939076571845, -59.84844319246931, -61.10697901092624, -61.84016518377721, -60.18138458732613, -54.79710835691476, -47.72767752217982, -39.730587372553806, -32.82533971477328, -25.062598397733908, -19.849158816179912, -14.366646088282549, -7.991193851279329, 2.1937093053790564, 10.998681654627664, 16.06768245313991, 20.221287512221355, 23.245099333135062, 26.644570382182835, 30.99830513708156, 32.276007223499455, 31.2133440734002, 26.717602095151882, 20.031135917367067, 12.229896218651994, 6.54992770167636, -0.26821014364310547, -7.176781849624668, -13.48822655722146, -20.83137830329756, -27.45268028099238, -35.56207513246877, -42.53754432317113, -46.67287649328375, -49.00961825696477, -50.12566235983575, -52.39178947443074, -51.40709443496406, -48.203974140191605, -41.26657345010892, -34.351552031960125, -26.83290373861979, -18.652308145530856, -10.265692805904225, -4.230790572505494, 0.27865620788874645, 6.160583809426782, 14.353525391735527, 22.35003228358383, 28.638555070184175, 33.22701111741618, 41.01164309113839, 48.513038867857176, 55.82711696560496, 59.891398033137854, 62.05156676667867, 62.06323757688513, 61.71892370661311, 56.74778786648845, 53.84449984878081, 48.9867218359186, 41.92235674550359, 31.159703403152374, 20.286168162257404, 10.30860805747173, 0.644132025269422, -11.42633054740243, -22.618263833211415, -31.810819029617306, -39.261328858190424, -45.80834251003047, -51.517080299821444, -56.64247327022221, -57.4678542346212, -60.187325986559195, -59.5504017714357, -58.76352961334769, -54.71176826574218, -47.72532330338392, -38.40655698724661, -31.265048725696648, -16.544942264998635, -2.3733322950833924, 8.113294206947291, 18.74613990832767, 29.915977674466383, 41.5712675297263, 54.03807828358077, 64.02155510438249, 71.2316933868277, 74.55018301759227, 72.3820893287382, 70.41978801222896, 69.69152306760381, 64.69730685085375, 63.27819984346559, 53.82124937894183, 37.5131660157686, 26.2212136097546, 18.474819170321137, 10.324735937969677, 4.757420856523095, -3.5224171533316007, -13.021341154057096, -22.795375718665795, -34.39311586216324, -40.39687614070604, -43.156279929588266, -47.27818914697414, -51.956326170500084, -58.54534820359976, -63.39314098103608, -59.5499199489095, -50.37289414810072, -45.853652551668425, -36.071118264640845, -23.83018700433999, -8.265937377282432, 8.2720285594714, 25.92138222848943, 43.22069452906266, 58.559947639020315, 75.90428341359754, 86.00226366406523, 88.59506007727524, 89.05193377553108, 86.89096416491904, 82.57533383645469, 73.5161617830299, 69.3765037653408, 73.582816367015, 75.54213265885268, 72.37702422246434, 66.04638755423892, 57.16669484628557, 46.84294311376962, 37.69155889190927, 19.28515942052538, -2.8143907502180285, -20.423672755318552, -36.197517019397196, -51.11261200708648, -59.46772749406889, -59.92109665226607, -51.42811559156649, -45.30324588748102, -40.19151427122168, -34.20140495997303, -28.15974769330136, -28.036921240905627, -24.178837403867497, -19.414019598924032, -12.556579788232959, -1.712935689501653, 9.58533629703065, 30.2241618432611, 42.28109167634464, 51.895746131464584, 60.60138459824989, 66.1420680850147, 67.95859104836853, 65.65572656791576, 57.639438522031234, 42.86000903192085, 32.46290885769449, 20.989784176718913, 11.023902642797239, 3.875284185636468, 0.06611948293542563, -0.3529628195447878, -14.837203404018924, -23.974785014125533, -32.98968296569763, -41.16940628741125, -44.16762086778405, -45.93698512936408, -43.396702451127716, -35.042581792936446, -30.06602306211707, -33.96612511563623, -37.545152181213936, -36.616994240105996, -34.378041251586524, -32.03113686777774, -28.434285879672046, -23.888571443728516, -19.766850793973745, -12.990328239599988, -4.180227672748681, 6.019427537544919, 19.364645797755202, 24.35239759743707, 22.817913086634675, 28.345600730449636, 38.327696530384934, 48.40061579477255, 54.86722564655417, 56.04540562781433, 59.617365517451745, 64.86988580794552, 63.64233267534236, 61.00163793357861, 58.459394513617134, 51.778608084533566, 41.58563268925211, 26.56482964106758, 17.904085414400317, 17.451543515611416, 7.528988652272979, -2.7190687660152464, -16.42115491219301, -30.106930882485784, -36.68563140346644, -39.70145696064244, -43.423632835695386, -38.77208334886616, -31.61197706331766, -24.520307694214118, -19.865574348294455, -13.186387477397576, -5.639591213244358, 4.946630503595285, 12.108303357068458, 22.3657414914566, 29.4914457308354, 38.66524508081696, 48.03159577700757, 57.54406654424619, 66.12514225387018, 76.27671376769479, 79.53885734007847, 78.22022942067073, 70.91363412674481, 64.70802988591409, 56.69445274231505, 45.984391327666856, 34.65564889861408, 25.849516235866318, 16.420614880551064, 7.805457544953535, 0.5864978219837561, -5.301480811131481, -8.486140167440663, -10.446944419738964, -15.41238403216782, -23.337263210680977, -29.42045070112751, -33.82562223039489, -37.521937225118755, -39.12287075225089, -38.97720538387701, -36.33740720372046, -30.956265569187202, -23.741882593024805, -10.328218041829627, 4.313932614522703, 21.962657128898513, 38.83765219355438, 54.30834638476089, 67.07183620991741, 80.39625282076828, 91.45553608643932, 99.40376856823165, 105.7365676374117, 110.01972683894911, 113.66059810916602, 116.65849452988942, 119.5022512657275, 123.97647672146161, 124.50844298425874, 127.01444084549351, 127.06581859487497, 124.9595413422604, 120.82331044353195, 114.46967691060135, 105.19234510706532, 92.28894763332627, 76.26784469459753, 60.738758615621265, 42.038039028083446, 22.19374013449341, 4.385283315559838, -12.977567572519181, -28.393082426035885, -35.618952903109424, -47.838439116966846, -56.846949711554714, -62.6637214994313, -67.79985587299481, -73.11915900974577, -78.2706954057593, -81.68613348372182, -81.74031617431817, -79.98080108024544, -75.86522845883246, -69.35624944957812, -60.869631052013766, -48.209758434405785, -32.87045383022213, -21.78389197348408, -4.410747214870245, 11.70527916813701, 24.129317294918913, 34.0322541169946, 42.17848372948562, 50.62766136830627, 58.594448581590115, 65.0195906298616, 68.1520068080018, 68.52257468855707, 69.73293180071435, 70.65514530359795, 69.92033426123028, 68.75898385771754, 67.66107388722855, 61.77627556641977, 53.41098535727107, 44.38439885968292, 34.56908900982597, 25.389984329271133, 16.7420705878174, 5.891135784043726, -4.26764585153498, -13.890688920563633, -21.73660784325649, -29.962657897669448, -36.48877284909456, -41.58845931485553, -45.36725642471323, -52.57324378311269, -56.17038865690813, -56.735451349454706, -58.635724587859585, -58.318179232483615, -55.537288724032884, -53.081473502298515, -48.055902571783534, -40.959497951959044, -32.270582776631834, -21.486282620785968, -10.913438679308712, 0.40901095394986164, 9.132480399443171, 18.580485438344937, 31.295268006281688, 42.183895819566466, 50.32002090345603, 61.964339904581294, 69.41286262831287, 76.06062162647675, 81.90761689907265, 86.95384844610054, 91.19931626756043, 94.64402036345234, 97.28796073377626]

white_raw_pix = [16.09608632907422, 3.941725574467798, 23.795405593192505, 14.948243402023577, 8.06582758881209, 26.95938561551633, 24.730347916217163, 27.438037239864542, 30.400375430494304, 34.33005388137384, 28.85685284539858, 35.77683858178458, 42.87645666653908, 32.0519085354419, 49.26694650819002, 48.68887448067522, 49.62056438208106, 46.93584207846027, 54.99153781055074, 51.90091596318844, 40.37180524716877, 46.88254262727167, 46.02703737699788, 39.55473089263433, 34.92513000523195, 28.8026164801966, 27.88744888027586, 26.504299200435305, 22.726344549494957, 21.206721587150266, 19.448469427185433, 6.357808912097952, 0.691661666051083, -8.096753037279322, -6.219312938753146, 1.5159228044778026, -0.1997891339530488, -5.011985634456707, -3.8778412566447575, -18.250419594347534, -30.12042973363963, -24.423121480209037, -32.93666905695922, -39.37107397431267, -39.88590270239569, -9.925637762567005, -42.19587125622459, -40.922958417261064, -44.16511778831788, -52.33435349158533, -52.025332316382936, -50.371346312189225, -50.91515445023884, -50.37146266609904, -46.215222466029786, -47.22209917365754, -47.679597978484146, -51.28377437053554, -62.426356103057365, -63.08417613772065, -62.398707125448446, -64.55369087453374, -63.316946431663936, -57.113566150062184, -54.58503438916432, -50.70738123818868, -40.65288362880431, -44.11475115666911, -42.51711251366207, -3.1576837782038214, -19.682984562957895, 4.859412770151014, 6.863371562189477, 4.284622129763239, 4.531563711236795, 7.30638603862299, 12.265482410790042, 12.739106103685435, 15.323863484095916, 21.395805378739066, 22.655005098158107, 21.145927359717277, 23.698485225806735, 24.405199496954026, 29.159817014188366, 38.694106483976555, 32.90550752772872, 36.69845855081756, 30.187087639276456, 37.33938569517073, 29.4033779567799, 24.36923076923073, 25.70877625385135, 26.484240018462646, 6.792835919116008, -0.8545362876733252, 24.101274494200332, 22.497567436070483, 13.335527696060053, -27.122653720231476, -26.0074604522472, -34.528183577331966, -32.24767667298561, -42.709437880561765, -43.328621460332755, -18.527221338784965, -12.998123133687907, -11.81725587913453, -14.966631609169264, -9.719964030517563, -8.333635558799868, -17.258219892160174, -59.269432472216785, -60.06293892498644, -54.46626097358506, -54.26261950316317, -68.41865190071225, -61.04025253510772, -64.64325466852267, -68.21244975318135, -69.7598000117871, -70.89823737161944, -70.39799108937402, -71.47042725397725, -66.4585399931583, -69.58646416355352, -67.19204071555366, -61.68178522144422, -63.786807074478666, -65.57727099995162, -59.3793206682751, -19.767433953012336, -18.967194692486018, -15.946701768619619, -2.6799465699709284, 0.7892878626819377, 1.8374466142197123, 7.435091666463296, 5.9228363419475, 10.006136730888093, 7.229876822165994, 8.003378927594255, 7.110260099819775, 9.162654920778147, 16.753427124316765, 19.749919740029174, 22.298741011187325, 21.82588510260986, 29.962659688514858, 34.072530720431736, 41.49788159069036, 42.54556295746722, 44.47397374307478, 49.72340005884944, 43.09407830621557, 40.587251018303256, 38.23629934182474, 34.646377123246296, 26.125878152441306, 16.65858714227385, 17.092299578203644, 3.7715796837167446, -1.9737215854990136, 4.303982630374885, 8.713146327183937, -11.29604670408806, -13.786865919622082, 6.359246502227601, -2.142441266063612, -4.274373669939327, -17.09089850889387, -13.5737718175546, -13.390870641361381, -23.456624027233577, -21.07361159672149, -32.79499145708226, -31.965128142956225, -22.767407706906837, -24.398840939041126, -22.309119006158607, -13.578152789058965, -16.238110600113384, -16.359347076829074, -15.793709563064775, -17.44566680308411, -22.600659014343787, -36.627168844573326, -35.193931042188666, -34.041644442191725, -35.64814745890029, -33.29445491287875, -32.38878609836433, -29.02094483333809, -24.18856670229863, -19.384397989210363, -18.848855577152836, -14.948742764376044, -17.382863240163516, -10.806850250662233, -7.58087615371192, -3.176035234923646, -1.1461853159520312, -2.3879003736592828, -2.3431893388291134, 1.1585180447478256, 6.967087827724987, 9.306329391669982, 10.382120775501194, 16.40487732352792, 18.66761902332487, 9.916574151192195, 16.663553976449027, 12.781357665390813, 16.684818865224393, 27.92891465354469, 27.873842172558277, 31.336943960685346, 31.455193008235756, 32.00633612587951, 28.59907926775481, 28.03134451299405, 33.72425110568531, 34.79672851945161, 35.95274023615127, 39.89822464503186, 40.5811688885525, 39.32140656018516, 42.59008396499036, 44.84018041094511, 37.10687771230768, 30.76865009052451, 35.04736992914042, 22.802085239685617, 29.864969895740995, 5.801115184079224, 2.8251630337972893, -0.7881305907857658, -19.70326476964495, -7.738651112696962, 3.018345589000225, 0.5883215469357986, 4.848442923085102, 0.26235960876866676, 1.173990720292195, -9.54404063120302, -1.952674310673721, -8.757392148429789, -11.089948662007746, -10.977963071087114, -47.42715432653845, -54.82926674832725, -52.72979251047595, -52.437281878958395, -54.75081391268227, -15.835454247661632, -63.70137150148443, -29.802979615440254, -25.912587530573067, -23.95321246161628, -28.462925919089358, -25.20125180985069, -18.955340077532444, -21.398323188841673, -12.79177195353857, -4.8906286073656124, -3.20663514045779, -2.4111864311107163, 2.2770417673054717, 12.005853278222466, 7.002353267966242, 6.928592604805761, 7.363405017571264, 11.393018019772228, 13.075258241315957, 18.69109292556785, 16.147316765134914, 30.354952324678234, 38.690891028665646, 42.569471094779445, 41.80531790853136, 42.85927201750865, 40.25689980322309, 42.04907317308351, 38.337012113346105, 32.96333663650012, 36.00337821987326, 44.44816847735627, 45.026362562035295, 46.563569856013515, 47.688952161500026, 38.23068340218112, 32.58800692432316, 27.43685926067945, 20.02268564920407, 11.249637580256064, 9.941557260182948, 7.639305789664409, 2.1138627850589398, 0.926814435798328, 2.7201953102906367, 2.538504793665004, 3.1213639003675575, -4.7088449421526075, -1.947821337828097, -17.319980693302387, -18.408188018884776, -44.954177726979765, -51.04193600540562, -39.12473369880853, -29.683458813930663, -23.51928831994976, -18.809221196808096, -17.811762496977387, -15.593110992040472, -22.211139454333424, -31.682451764521442, -36.681384454306816, -40.308254358161925, -41.300286607575224, -41.28441409158464, -41.27431106481083, -39.0, -38.0, -35.75086382048119, -32.252951540595696, -27.30581783846815, -25.260552555989243, -28.73962067472732, -25.162531578643126, -23.720217539174385, -15.464768315527971, -16.658274588256145, -11.539982938708413, -4.2256231996057645, -3.0160581945141214, 1.6603514368327787, 7.231229911228402, 7.127545007729134, 6.338673998340646, 7.406820607029276, 5.228294883785629, 14.549416250315565, 14.534398197533616, 11.415635859707901, 19.01449820209479, 19.60788409009657, 26.160746785772453, 31.642500246946792, 34.264408625158595, 38.30427413985798, 39.16171245350618, 40.027773645682636, 43.13325777042227, 44.81894475522176, 45.58863176242963, 34.36538956566619, 29.948180384536226, 31.323832736941824, 32.58172937472941, 32.29092548350231, 32.414535914082954, 26.132758062624468, 25.08672853585083, 17.051846849459473, 7.927323208121242, 9.21393630937414, 0.9313029296761065, -4.4516100880937675, -12.412803570114193, -18.145102944906316, -15.775796118196437, -21.537184399319937, -22.351559281585512, -17.4242114488937, -17.34614598541303, -14.735793614892875, -12.39194275427319, -18.54576677922791, -19.420056160142646, -14.80242428475424, -17.211337417967123, -56.78715204324597, -54.551215034129044, -50.325560791366456, -56.09410420899435, -65.86324835100756, -29.903772055856017, -68.0293784351675, -66.69189759758672, -65.96971782359515, -63.836173167068736, -25.442764645371895, -24.466425614134447, -16.00116694272775, -14.715814285257524, -9.821156756260773, 3.905348621347442, 4.3374734243412245, 0.8322373665215524, 2.084855111260841, 3.666124737135233, 4.748887905554586, 13.346322632561812, 16.534511970253114, 21.333088407700743, 23.896865540657455, 34.87711239886802, 39.69111506854668, 41.847289467002796, 49.36891097576239, 47.31426584936895, 40.834256324897034, 42.22973020997971, 36.55291406199509, 35.340727639660805, 31.34355363542556, 37.2048537890317, 41.12760325227762, 44.349947105032484, 47.90682371426078, 50.47308468901157, 47.85233697371688, 37.53701676860988, 30.348476290262173, 29.04060050276833, 21.35874655768838, 26.79468720051207, 19.131409012689353, 23.57659647872516, 21.043070375085733, 4.171147828937111, 3.2839374349379047, -0.30741401256378365, 0.2294865157102534, -3.4966997172119254, -4.506305525422151, -2.037612827090179, -29.348971942883534, -35.21750304632005, -6.565791435240349, -5.0555859140223225, -10.485121053249943, -8.105255534913436, -14.88292480498468, -54.578935720434515, -60.95797289711129, -57.9754478637143, -58.672583528329604, -59.4955547256179, -66.81584877152149, -72.79562474690792, -74.32281672579524, -33.460126388330394, -29.26303176178789, -26.068715081839706, -21.91670081087434, -11.677255737929562, -10.440933887190425, -3.6037141684042346, -3.9204623060839072, -1.3269994410729955, 0.30739972136993665, -2.2740046774187515, 14.677601771084433, 15.508051843728003, 19.329954532388108, 23.098588825072266, 23.16896399621456, 26.982094169909875, 31.67006737111813, 39.16777383485973, 46.94848391959799, 43.81065787722389, 42.09759500644643, 42.8978622392033, 48.41262888241522, 50.341284087285715, 54.54793203218041, 57.32527219739651, 59.949312457201266, 66.64387824030966, 67.67229505032911, 69.78596756713787, 69.78596756713787, 59.82393436157465, 63.46592940847019, 66.36392683489412, 60.16528956936476, 50.90323344599761, 47.544205282067075, 40.06960897018819, 33.768390471508134, 28.83275011587681, 33.43480552065935, 25.999999999999975, 28.051006727631044, 22.202274121437412, 17.951893914591395, 16.312689215798937, 6.8348612617340585, -26.836684039945798, -4.437621423718606, -1.2595648856463906, -0.2755298187351878, -11.731540440022766, -3.2707142834703458, -0.9061951175536113, -6.588869001741551, -57.313950865103884, -58.79343146431432, -60.88805523927661, -60.619384660955, -59.963091211947216, -59.47983014639527, -66.18964176716794, -62.273840542478524, -69.99202544315419, -70.94639225043358, -72.67453801854946, -65.34585156810141, -71.36775516074422, -69.64443819577549, -66.36233046020605, -66.68273580622822, -61.286381207556346, -61.2956149489362, -56.218630681509545, -55.95081233561521, -56.2190617278019, 0.9310108403762843, 3.6923790929882396, 2.8716243453165102, 8.998664924595142, 10.090091909944672, 9.984603532054091, 16.016096749407208, 20.07412573694017, 15.135349969440297, 10.200693038688469, -28.973475716281776, -28.65811028228407, -19.148484140396686, -16.4218794416016, -15.603847763631254, 36.39985352937865, 42.83331388818693, 44.901604305715594, 47.472817181874056, 48.433848358835704, 52.38461538461533, 52.362621534680436, 49.80825121244934, 47.87041125845597, 44.560460392035836, 38.99801055933755, 32.37321343371628, 31.858176285318287, 29.390527710007365, 29.28015903956991, 27.896588545227747, 15.122090344097304, 9.04314928861206, 9.517450189810706, 4.110960958218857, 9.043618171047433, 6.991151919945644, 5.312890373771237, -45.02654818541813, -48.791417941094146, -53.46504682622747, -58.99886824062071, -64.63411772672322, -65.2279700235604, -67.60615071422264, -71.08959849736867, -80.28208831315614, -79.79659941417256, -83.69745463631592, -86.69596552539343, -84.88386263118863, -81.49370278853735, -79.27615065338838, -79.06939104054439, -81.98015745023058, -82.99351638478873, -21.290887412046754, -24.920587215389226, -20.677427707466705, -12.509789840161154, -15.549205674373564, -14.336685130829268, -13.627152392870821, -4.954943600400633, -52.79507660222073, 7.110444092917528, 12.703570939702967, 17.001717388563552, 15.842919783156153, 25.808485152943103, 28.738834604379402, 24.839389394596463, 27.511815643464935, 35.89476502856893, 39.01502205178607, 43.558656845852376, -13.35746826167846, -5.308764655906153, 38.59430945593108, 46.18811293655269, 38.362435775038215, 43.242996577862506, 40.717705431252405, 45.220570540407785, 53.209274627508506, 59.037804372203446, 58.165376941121046, 65.50734502987093, 66.00429293675053, 62.33789660012875, 53.88942820027933, 40.2049029999655, 31.787067833202396, 27.124839595413675, 26.11365646022981, 22.56476528049981, 21.29005827932, 15.337415043817478, 10.181034591166767, 9.090908016650944, 4.267975325947851, -2.261163531616159, 2.3120678518113422, -2.3603140391444004, -1.1117412549619379, -49.77041517368714, -55.120170217073145, -56.898305659643185, -62.3023243373343, -63.275664375932195, -70.81449288385488, -71.32354898483715, -9.48846010630708, -70.30072487155876, -71.12426514814437, -71.01428672412621, -71.10907237990634, -74.47724121810279, -14.16474946437583, -13.404720741216803, -11.239999999999977, -7.359789349636267, 3.2470139022507682, 14.230249470757707, 17.48452389098495, 19.834569987793472, 25.252682882861553, 31.689514723527335, 35.75218207131552, 39.66845974243636, 42.488920098079525, 51.039988218406656, 57.49851857392241, 57.02280573046006, 54.948856365002825, 49.88307237745171, 50.907663183204484, 53.27835465412902, 59.79976099435659, 64.69869892663412, 67.25054082736341, 76.0007366109122, 71.23019082002037, 72.92107553889953, 71.69765190812176, 77.04273264383734, 67.0855899770095, 68.29279147669767, 54.39759959901711, 47.499327930468205, 8.820599088849075, 42.174546122906165, 33.81229310872563, 42.71986865114647, 42.054726681048216, 28.455251342296418, 32.060556439743245, 24.958470399636926, 27.19718866902477, 20.781800010558076, 15.880710559018082, -44.670927942888014, -45.23760272920589, -46.76109364326681, -53.93496201657229, -57.98989448831136, -60.09232840721822, -63.73427148947803, -63.31799402014142, -64.62213096029093, -64.78440563224976, -68.94689058841253, -70.59863027389608, -73.6724642563073, -74.2885469612038, -73.65259591210445, -76.1901025915576, -73.06632970257355, -75.32885721613233, -72.43872080562082, -69.78617401499417, -68.486934278563, -62.94242795153536, -64.38551231871746, -64.42097696957651, -57.81687312232046, -52.19664776329325, 15.461336458722398, 18.936783448462506, 21.80967178049395, 27.12947533606964, 32.44631648922889, 39.436566508596854, 40.911468728994876, 39.8160558077609, 45.76724551408037, -12.520681136260553, -7.844656112978243, -2.5685312955139405, -0.010650811126749947, 52.05232259687548, 55.28616744977043, 57.37873506783918, 54.146744697316436, 56.382264442097195, 58.70575262980137, 62.25848577520876, 6.558760632959708, 10.908777874731381, 10.261503355278153, 9.65628185026435, 7.589992685384724, 4.786185863655282, 57.64053828514911, 59.32439812125993, 54.98284926872726, 49.64715835845946, 44.30285701216475, 39.083132864311224, 28.965248168905767, -32.32508307734029, -31.742562245030772, -37.195071528989594]

white_smooth_pix = [11.191108289165518, 13.079038821754427, 15.040453225659977, 17.07535150088217, 19.183733647421008, 21.365599665276484, 23.620949554448607, 25.949783314937505, 28.927981043014967, 30.644016105361064, 34.609944328442396, 37.0495539465403, 38.60558345604271, 42.36907124697279, 44.520419178523944, 46.35328488746536, 48.256895140348156, 49.91403803364637, 50.07526712416434, 49.30243613641659, 48.13241530459688, 44.78860196965552, 42.08726285863729, 38.900819349247904, 36.34429511868046, 32.95912153011997, 30.304527008028863, 26.605494105741247, 20.723757484492562, 15.918402102965292, 12.139600720554633, 8.267106659868626, 5.681392221039973, 3.1905805724659784, -0.41232893813936267, -3.3910360853059447, -6.357686479605331, -9.54861946655057, -14.733269622811001, -16.908005790137302, -20.051963835275092, -24.200327168433347, -28.018635761985074, -31.303989677204555, -34.429393829806244, -37.21860212765222, -38.8731561990521, -41.26050710796549, -44.1100315769702, -45.74734189697186, -47.351867585242935, -48.76003742104131, -50.87668166041024, -49.446644771515494, -50.33105816150746, -51.25912228930383, -52.833587804020176, -55.15909582991442, -57.51945103008349, -59.892203798408644, -60.92082416101955, -61.14529736779161, -62.656703454075355, -59.66123988685247, -56.420924849019215, -50.62124809850057, -43.61733411937973, -35.69193854877085, -27.477300985297333, -19.916852858051456, -12.729220414788658, -5.947938550958089, -0.38704906517377324, 4.376105589022132, 9.076930792413105, 11.577966759734943, 12.034643044011148, 14.940553110767224, 14.92212269044327, 17.744461602199557, 20.62958969718245, 23.793796675669157, 25.8124498360977, 28.305927783936074, 30.821551768848437, 32.17371849391545, 32.700249511320436, 34.45577626413968, 35.13150779202449, 31.821912649850212, 28.52882264388478, 25.605458468838474, 25.34772560457144, 23.5688584386693, 20.135758712463318, 15.25170150241825, 9.425561336613043, 3.3621351773222785, -5.648669878589095, -14.266189002655576, -20.92921689322136, -24.899522123676157, -29.389644822882925, -33.29043015794905, -31.717035677614405, -24.54902002330534, -17.962722518132487, -16.75400321480574, -16.90457570167133, -18.3898032823928, -22.466653797682156, -29.208135370012773, -38.0099418052159, -45.55410451237214, -52.49598808231464, -58.73133545960545, -64.10446074236718, -67.65751826236786, -68.14068830842152, -66.93533211560958, -68.83395002737936, -70.04753533187709, -69.87652988064303, -69.27265742158602, -72.10200912476104, -71.35575833353147, -68.53677101763206, -64.84386138402073, -59.24034087627129, -52.00669998221349, -43.90155324456009, -34.93126913611866, -25.524206353000636, -16.397879048388464, -8.134132894028996, -0.6493851243835799, 4.484850503125427, 6.257435780097454, 5.747372814049754, 7.5207624633851085, 8.897876319763482, 9.231447944602614, 10.56625385728195, 12.15848780422716, 14.49416028543757, 17.914883386687215, 21.37740950442452, 26.352276702604314, 31.1264548347823, 35.519989157758665, 39.008905714549435, 41.7956111352171, 44.12126512568921, 44.52433505573069, 44.17060697651543, 41.543501662029236, 36.779773244729526, 30.664310953070306, 26.187541654602306, 20.853478497933224, 13.598012780329356, 8.746375546057076, 4.452819674229026, 1.876377129607091, -0.632405268855426, -2.461698620752681, -3.367283277018948, -5.171789844581359, -5.648071518139667, -7.901220841262384, -11.997392538930386, -15.084946679864352, -17.110162216836763, -21.200990786051285, -24.872584136113623, -25.497218786252645, -25.525245839340208, -24.33326812304039, -23.291045552983054, -20.680694975590786, -18.55983320924173, -18.02066742751793, -17.6539786664205, -19.507625486799625, -22.37282585902945, -25.143123513683307, -28.511859525816533, -31.746450004118515, -33.184580183662604, -33.96430679973925, -33.21448731168452, -31.64020343855133, -28.872435966845604, -25.461875036772785, -22.695941899415452, -19.338469923696366, -15.80305446709762, -12.921324719646176, -10.512241471909327, -8.3417647081108, -6.136882100231319, -4.098993964769812, -1.5971810457198576, 1.690252258179943, 4.317257406770833, 6.593650713108479, 8.515724635356367, 9.563948336029414, 11.359913744602613, 13.340673026503584, 15.368207319831093, 17.207554244594398, 19.346378458039347, 21.661734621002758, 23.39641261371121, 25.025812882324246, 27.153866718130033, 29.373395703896875, 30.618951594671458, 32.34843067714007, 32.937833438529594, 33.225670044443454, 35.09590921279442, 37.04080546841507, 38.337927294903466, 40.18242604628898, 40.526518001591675, 41.55546670806782, 40.515640269907294, 38.30647403377925, 35.8218256362727, 30.17568701645083, 23.125473795060532, 16.481958683927136, 9.747252126856843, 4.68842363514954, 1.070004601048888, -1.0596383992367353, -3.6299419285888357, -3.7734976863691556, -3.868951378677724, -2.0981510828886116, 0.6664373810414109, 1.6687788913368817, -0.032708045309042075, -6.061877074433198, -12.92685837539318, -22.62463493182138, -27.31331520367729, -34.67011415080734, -40.898147260179556, -44.91022696294394, -47.4377124956844, -47.35637073095979, -45.923131626773284, -41.85107798693898, -35.81254507267473, -32.211885726832534, -28.910935332448183, -25.386649534481048, -22.42289174620735, -20.89339757882583, -14.150456609313967, -12.462886610255936, -8.438384311388559, -4.491693549341202, -0.5245393924544663, 2.201761894224772, 4.987564018528331, 6.738147435282993, 7.606909942249731, 9.294604712334989, 12.377682608679407, 15.928793854161038, 19.851950305720536, 23.867170588742933, 29.140834192716227, 33.92045872604057, 37.355439839567154, 39.07289472506193, 40.39293338916121, 40.931212863835555, 41.17690758294369, 40.94243112629474, 41.263405900993305, 41.8532550009047, 42.572557428781735, 42.83846464039376, 42.00497631076364, 39.91665814488379, 37.371793923576284, 33.41003453410717, 27.596962135598886, 21.26765690615669, 15.613355715271396, 11.125435787996558, 7.146941340054058, 5.631592079078471, 3.727020745840955, 3.5553048541357013, 2.2573799149374874, -1.80364084880745, -7.800231742515359, -14.051666808535165, -19.960545960213725, -25.30831119201763, -29.707470401293726, -31.902063226383866, -32.06599464841389, -30.754590608063758, -29.16911656118695, -26.484545887419017, -24.80657502136169, -22.982427943328172, -24.563096077248513, -28.327232820155736, -32.33336747832128, -36.08148624511728, -39.226161317935805, -40.975464162037, -40.93660549186278, -39.508119142902224, -37.28287826413955, -35.47451613517405, -33.02608610925615, -30.794654840267494, -28.729533851396575, -26.166640476574006, -23.614637482847414, -20.89361800650233, -17.665370946282692, -14.056131113151402, -10.305862417771221, -6.033725027870151, -2.559767694592835, 0.42132648245234994, 3.476876468437, 5.254843823331361, 7.4200049433777036, 8.526574061493196, 9.50035490652864, 11.175958234701756, 12.934094941579264, 15.461788117785286, 18.91850032817878, 22.500540941167454, 26.091157483158884, 29.724766410628146, 33.57759127177648, 37.5881586627094, 40.24835387011677, 41.07715001364221, 41.349994473088984, 40.44351882891045, 39.567794070452344, 38.22358324598944, 36.86863403239767, 35.56456827041189, 33.06563041445426, 30.465035074016093, 27.718597012489, 25.08778086825179, 22.38041719245964, 17.604015458035413, 12.12770143320312, 6.179438563835688, -0.13852995156684467, -5.825981861980575, -10.569521379988599, -14.62497364948905, -16.586193314275896, -17.887354262028307, -19.341627422203704, -19.11167793075696, -15.735963851333258, -14.490375195472804, -15.632560837784943, -18.0588734070619, -20.80232701322111, -28.265584119535887, -32.408778684150235, -37.452143856938896, -43.1526096901842, -48.76482998738699, -56.118893472481936, -60.86711703655711, -63.10495019777977, -61.08087220871625, -55.62269250495538, -52.39818578098682, -46.983337118565075, -39.176554992608864, -31.111569227867047, -24.198525323189138, -13.255542635158038, -6.870422675637121, -1.9378228202362906, 0.8973790224081319, 1.5729944598283652, 4.040374876581213, 6.359231401821289, 9.566501167533351, 12.486702202139524, 16.313362336176038, 22.257429848400026, 28.07987322576937, 33.51586870776292, 37.96256546252613, 41.36384257883578, 42.540333912201156, 42.846968686721084, 42.182586812915716, 40.9299315570235, 39.17612088405551, 38.56033779164241, 39.221904889132816, 40.21820283142078, 41.639532286167295, 43.21559057005847, 42.981716173405445, 43.009201906681085, 41.247710388172386, 38.84187422525103, 36.29335853618183, 32.66829980518933, 28.533748387078578, 23.89878963145463, 19.765099749705833, 16.257456612723686, 13.015338434578437, 11.51663645716725, 8.7321340753116, 2.7464848552561723, -3.228844756802135, -7.067527126119889, -10.796743462716625, -12.205639781252316, -9.747115131759838, -9.94016844890411, -12.221063682964147, -16.007880106156744, -20.48301329713252, -25.25702070388587, -30.225122357989882, -35.07639728368063, -46.208396752714904, -57.10697548235752, -63.08895576532976, -65.64200229444164, -65.6198004002093, -60.968280848411055, -53.084187548667394, -46.11849118120526, -38.83774481326972, -30.674619776076838, -22.055102105991004, -15.108335672561683, -9.172532348772577, -5.458743124132435, -4.32687388366112, -0.37601030707966265, 3.318660252969239, 6.591212745558812, 9.3883914725037, 12.770999093451687, 16.955707287288067, 21.99742746976841, 26.66240565151459, 30.629928724901358, 34.120540468733736, 36.178755684187315, 39.20612239416938, 41.934418661016025, 44.322798718421126, 47.049457547036326, 49.44793196109214, 51.91201518465079, 55.13748604332162, 57.940346179859944, 60.948493717316396, 63.841340522395384, 66.25070050564119, 67.2832822788623, 67.66665346655911, 66.76393122210399, 64.64733679725076, 60.628954380917676, 56.25428587461951, 51.398066825602164, 46.77622983892261, 42.51053886079398, 38.44807450214183, 34.13545573542231, 32.3242005875734, 27.732382191487773, 22.814976431339367, 17.653553967302127, 13.844877600178267, 8.94409154084734, 4.003149835984564, -0.17422993999559033, 0.5118779114667698, -1.3905954247707522, -4.362488593640287, -8.862514478863183, -14.32594433028542, -19.917846271826217, -25.608374391625343, -35.93532461181398, -44.01277413739727, -51.38984683478415, -57.53413141228691, -64.2027121449595, -67.49041631892096, -68.00626888620297, -66.07500837727997, -67.3009789070943, -68.64893520285274, -69.53406818579869, -70.12728707336522, -69.71244904679111, -68.24926005652343, -70.80165769767508, -69.24308020830047, -65.07530927954508, -59.091214448715064, -51.41487748914243, -41.50000471776778, -31.819799335117537, -21.95269603984119, -11.467327351481787, -1.712772616139883, 9.46697018846508, 15.950902148846616, 17.519678333250713, 14.64078073430559, 7.220220873377311, -0.7351211031496607, -6.451623796827189, -9.847277040885196, -10.2912662571467, -8.124973545836868, -3.9328610328372497, 3.2925186234305133, 13.535629262224568, 25.340210837300553, 38.04070501489338, 46.18471935332241, 51.66347608148243, 54.33818786548381, 53.556392244476434, 48.49041332070367, 45.95921204520495, 43.96983634371625, 41.26564362699831, 37.50598232570569, 33.43321536617592, 28.830868252583905, 24.637107506407965, 20.74468301119917, 20.78925736570135, 18.585694252878003, 14.250878837372753, 7.840449627315312, 0.20918408184665682, -8.81334955156489, -18.12632425745456, -27.120117547485908, -36.40348160353969, -46.36007652621747, -55.348572509084164, -63.63592545630781, -69.87882696364747, -73.84802862921201, -74.51738358649455, -77.68053985522977, -79.76324081616858, -81.17799619526367, -86.58968916413268, -87.92955600498959, -86.04352953063328, -81.61117439139561, -74.10010144422132, -65.54628640674937, -55.712614288070995, -46.28620475354974, -33.54176572143981, -28.17616982574091, -22.780649523246204, -17.668894174846532, -13.163176093934258, -11.403954783850144, -12.12853913029396, -7.052113828047383, -2.1787659923685743, 2.6390221367633586, 8.661134208967795, 14.535209423711919, 24.755496952858316, 30.876950384748334, 31.990368258094524, 26.008319352958562, 25.310439774538345, 24.73164855286478, 25.049915614193527, 24.919264161229737, 25.595043198619194, 27.22627343018173, 29.660594963225673, 32.602644140824864, 37.66214575527544, 44.73452599430716, 54.10629094469187, 57.27870660779956, 57.59851007395933, 59.404287908784326, 60.178083745378295, 58.59247838002979, 55.61720223986002, 51.0004472670613, 45.313396479991596, 39.02441844866122, 32.96539478594525, 26.892846489701764, 21.204932445736983, 16.98713906108227, 13.58033727423242, 14.25535769991226, 12.292155448618647, 7.738601072534853, 1.4811947451459422, -6.1612218253890205, -14.402320367468434, -23.330932069647574, -37.278472056156254, -43.45963357159205, -49.29506318923711, -54.771464145841115, -59.749222771545334, -62.2865550979495, -67.38201096718865, -66.12875709814003, -65.2886032781704, -62.49041309554812, -58.246436380268676, -53.030360883997275, -45.997056896256666, -38.56781105109847, -31.158372978886828, -15.749185172845051, -4.893411408007414, 4.913875343506151, 13.086548536432266, 18.363462949411698, 19.90762391964217, 26.041231950257895, 32.04846665334953, 37.62724763077373, 41.83514072413427, 45.31409923662572, 48.25130604727912, 50.46682858419621, 52.127251221186086, 53.123455866568584, 55.053292705953304, 56.88719245933633, 58.86474417745737, 60.26347613318002, 63.19853210006936, 66.3514607373308, 70.25080017537492, 73.22971262510778, 76.57571271921177, 73.44994515974199, 69.39588371513526, 63.53869241009582, 57.531228135294185, 52.4538046731262, 47.551449767525675, 42.94413393037142, 38.48007973970271, 35.04715168031042, 33.390248781348866, 35.9025133165744, 36.121252144996035, 33.09380365284759, 28.05676870606611, 16.352450877981354, 5.520926964183662, -7.058585536414141, -19.21333232074915, -30.554866196858303, -42.12295694227829, -51.34329403406934, -58.99939149420496, -63.42690498618829, -65.14141831891644, -63.63852220432288, -65.87890136399207, -67.95339244947903, -69.18886587590839, -70.7298368321351, -72.25097783040206, -73.37484624809025, -74.59281692776239, -74.72777346532723, -74.17732045524384, -73.3447728975598, -72.3403821844501, -75.24828683440843, -74.03362155367797, -69.12438270491663, -61.23642548129812, -51.316760816950186, -39.4941346149256, -26.456677261880177, -12.41491635510651, 1.2067773169523823, 18.29378035023118, 30.614892299347396, 37.35531947446157, 38.60257056165203, 31.369799097660632, 21.95517472552067, 18.657361557555443, 17.32025527565375, 17.172364812240623, 18.580134664871828, 21.689401714577333, 31.246609112940718, 39.24075170642735, 46.33556380174421, 53.652940451708204, 53.09101353562845, 49.14149170412995, 37.97142182860506, 26.21709543467763, 20.90931897460178, 18.569801033457697, 18.949498926803603, 21.200000308220385, 25.986774046307435, 36.64728873307192, 45.80578612786407, 46.81544338868264, 42.98342786221122, 36.10608773593069, 26.183423009840837, 13.215433683941665, -2.797880241766869, -21.856518767284683, -43.96048189261182]

nurse_raw_pix = [-11.271155017839883, -22.952297925259657, -24.664507516560825, -29.793313166446588, -20.50609665440989, -33.16816916111412, -27.903281230856706, -18.067663355023917, -3.1340359197089205, -12.057267945969443, -13.908357253857721, -4.575339092422677, -3.65870723259757, 2.8875024150070385, -2.9117919070722302, 5.302679746304413, 8.901904427650502, 14.377420275443054, 9.149014964961358, 6.227264244412813, 2.0003781790711725, -2.6030390458785173, -4.054835294771629, -5.146502354656713, -5.409769156092214, 6.133493193263856, 2.689655172413746, 2.0603394259938597, -1.4830715582475764, -9.257244863703603, -17.3048557366246, -17.4, -15.787044347526475, -24.24591020872826, -21.60044462322003, -25.966454003663067, -22.04551975986151, -18.74783276125451, -14.142135623730951, -29.585479124277647, -31.767831856506472, -26.501552135290105, -21.84386189918404, -14.24441890817399, -7.056077897395825, -7.444541124610727, -9.392832775958363, -10.128053597345938, 4.714103549692996, 4.599999999999954, 11.733241204816208, 8.67911174428305, 14.988737227233889, 13.734249562367978, 8.912804626151056, 5.1097091889775, 12.428883276771934, 6.790191801971548, 6.67455762810176, 2.2188007849009166, 7.634743021122126, 15.060093828588492, 14.394723303834096, -1.016365369972748, 5.822396133543794, 1.0075854437197567, -8.010188812564255, -15.577183591671679, -16.23326557334615, -17.235924056622025, -22.987700076200905, -17.062296931919096, -10.756201759387892, -18.600000000000136, -24.12955229832592, -17.04551995659574, -11.430471123409356, -24.400000000000045, -20.323372786961997, -18.727900217999462, -22.78606812197789, -23.66889608540991, -1.3999999999998636, -1.2240367216524826, -2.364453689086251, -11.326586806859064, -5.84792047011765, -6.050767314590716, -3.820260056955966, -5.525300388339606, -2.036446952010503, 5.399007603600848, 5.095112552218263, 3.2100967321939904, 7.141911267421709, 5.878163742935696, 2.120460406894336, 1.6959966080100797, -2.5736847536186507, 11.86761060005307, -1.910107869171225, -5.1716052909464905, 7.275197413770146, 3.2636579510917496, 2.67369569110787, -4.442377181859559, -7.284531069730279, -18.52526262457232, -16.297696980047764, -14.277902176651894, -21.14101210703724, -22.236081016426212, -21.251033177324928, -18.975446439216245, -14.81644447993606, -20.397003109502634, -14.421811248028368, -20.503276774086874, -9.52500217637822, -20.376223965914296, -25.25582560220826, -21.65688077052192, -13.051031964911727, -11.20956776478723, -8.664498997321248, -1.8715508816761546, 2.985674205715815, 0.6095569153306135, 7.5700262073089535, 4.919349550499638, -14.446767652105452, -2.5575396488867392, 9.603920767980535, -1.9351392095533138, 3.5777087639996634, 13.059456538073885, 14.548067426289046, 15.519882275430854, 8.347363751004645, 11.817810470585325, 6.536192428337601, 18.335757415498378, 5.265448782780735, 6.889986220041484, -2.057776648752625, -1.2626716210644435, -9.000930555455417, -11.494580823517953, -13.815358936306106, -23.084766511845885, -25.458256865692793, -10.707252607668062, -11.311240534819808, -19.147340831758406, -21.41687083851921, -20.233515433420912, -24.257534999151297, -20.543015105219084, -18.609542404184708, -11.327067571226719, -2.045047899103504, 1.3251601871720566, 0.8682858895590796, 2.1067406495302703, 6.078701663629784, 2.503670175697687, -1.2649110640674237, 4.088658346184367, 10.140789232029821, -1.026623574729599, 5.758125345339595, 5.0188561322848875, 13.254862147845078, 16.22107541660643, 20.70159451646019, 14.106351707387553, 12.952435691316431, 12.553883861180072, 3.9327311941842127, 4.007928145104239, 6.079789502853015, -2.043883675591022, -11.169748405659373, -17.472105544807913, -19.52140282251063, -7.821251467782701, -14.880591515269268, -19.14628969246085, -19.02107792734041, -25.063808073357972, -10.295320809632267, -26.733919473365706, -31.190179806058605, -33.95164003971148, -25.724351047380985, -13.335897189396515, -5.093248125763048, 1.342493264747468, -4.3640153041128595, -5.207962696945169, -1.847301259312281, -2.822265812838223, -6.1526723469279885, -11.389240292129083, -0.4616435357484908, 4.751499450143966, 19.382920710313904, 16.66430231489624, 15.105858011025493, 14.4528175054293, 12.216923095174447, 12.965338406690284, 7.182372320378749, 2.952122271643949, 14.443707614569512, 2.4804856356696674, 1.102484024257326, -16.081523081331046, -11.162185360513941, -16.181665954591242, -16.24687301138108, -18.91803278688531, -22.923521335320356, -21.70066632430716, -25.652413576325444, -26.849248537426654, -29.69856785870854, -26.68802541659726, -31.841190086719564, -35.178985747462775, -20.60508771116021, -10.774942949616703, 3.0020450310131914, -11.9260542188424, -11.001827618293694, 2.7487119842178553, -1.9862541326456342, -0.18004141428840367, 11.695909619003722, 13.8845195100233, 6.784594142366009, 8.975516503640021, 9.950819672131237, 5.36905856164155, 1.1379315713086982, -2.1209125149787913, 11.132020430397876, 15.811388300841896, 16.564683910544026, 18.26365919568252, 14.477888663979483, 4.107443810207931, -0.5185360817241818, -1.2999863582394848, 3.7675587610123573, 0.4897285216282996, -3.3411529076494184, -7.7919959175692135, -11.942317995590553, -17.305629593234098, -18.980844850819494, -13.795543889662321, -17.34877940544681, -16.80022091165497, -16.015167821613684, -16.60033666840504, -11.263292927129175, -13.203919695357913, -1.460942379083838, -13.743788738606243, -10.210488552942536, -7.849243241805286, -9.3002349418275, 0.0, -3.338753429957163, -4.756566867685345, 1.432537700003447, 10.838459075069187, 10.671868317627196, 0.7851358838853324, 2.0, 6.536389647963398, 1.0, 3.5646868348922225, -1.3557374834630225, 2.8464441658018234, 5.311587860110896, 13.878483876462795, 15.261052585827759, 10.91363552217762, 13.74061025500497, 6.378639476000581, 5.232590180780516, 0.3359268036939451, -1.2172551106515723, -5.223945193001875, -13.017028516681563, -9.312661473328419, -10.265290236724331, -10.02450807395118, -22.847262144907912, -24.521370317677963, -17.64385663215086, -18.20918058084278, -9.14523696336095, -13.70682550530626, -4.702897377529355, -4.302885436468812, -2.3210585341948646, -11.328280948077666]

nurse_smooth_pix = [-20.232266922622173, -21.625419893873467, -22.526088063242156, -22.93427143072824, -22.84996999633172, -22.273183760052593, -21.203912721890863, -19.642156881846624, -15.974535396200263, -12.691061940730815, -9.380686564398742, -5.858798095530951, -1.3475519826181996, 1.3961609710814766, 3.416537155612666, 4.939914242096562, 7.088974336665393, 7.459696601967654, 5.514222361237037, 4.335498895307424, 2.8934798026798285, 2.14109094036767, 0.910959451518353, 0.2989032384017367, -0.6795440056806157, -1.409300081041462, -1.9073947165492493, -3.2650639182881234, -4.93500900468418, -7.884460479554275, -11.503418453291568, -15.576094006460668, -18.252641892160305, -19.681656674032556, -21.485706873550754, -22.84426118896744, -23.878716168962228, -24.755067113698757, -25.03602380509794, -24.172187777356605, -22.223839214598414, -21.676755463701156, -19.76650416761025, -18.040778407039124, -14.786399248820464, -10.969851462549595, -5.529316846402179, -1.0138485151936416, 2.616968333216915, 4.869395888213737, 7.075745465829144, 8.927758307795347, 10.993513021492536, 11.628621778085833, 10.680035226234711, 9.037279403550528, 9.581107907158087, 8.68332039701923, 8.615362813153702, 8.517780216756796, 8.916358973385492, 8.467204061466552, 6.8424158723799, 4.359567412054081, 1.340148269569931, -2.871038220038918, -6.306355254771575, -10.041605374638115, -14.039597898692852, -16.84664871092632, -17.14633037233238, -18.757977972375862, -19.020285987092397, -18.35311149317009, -17.949456119486058, -19.772960870159686, -20.437662687259632, -20.067045495528482, -19.04659932737031, -17.88304659308033, -15.450083804047136, -13.50702863630599, -11.970389580391275, -10.119698066421634, -7.855147452589483, -6.470202131076401, -4.660851801839785, -3.24546141417261, -2.4990578764388967, -2.4265555882576963, -0.6059747458362038, 1.6297260135611544, 2.5118636697313015, 3.723339347796842, 4.892681026434689, 4.268762542964803, 4.060715941653228, 3.2971037578947673, 2.9277786786810367, 2.9730865275081935, 3.380811471767686, 2.411512875394607, 1.0850553030238301, -0.09311834132994412, -2.1825600842923416, -4.977528714434648, -8.855821716239085, -11.346548980853546, -14.165511901673298, -17.8189263592843, -19.01283910651092, -20.54688910352272, -19.817824072836125, -18.71873985416442, -17.882177735990645, -18.643013804485488, -18.8872996814209, -18.463337763855023, -18.64188667387399, -18.666801683824346, -17.71237896645321, -16.551231563976934, -13.857493966317735, -9.876036716589212, -6.960154061770428, -5.693297526473642, -1.9001653269073013, 0.08628389386219104, 0.2336214801855251, 0.24563967245066487, 0.8697444399631109, 2.135730162996137, 2.8509288056132345, 4.44423372396233, 5.468381952240771, 7.668990849764617, 10.211000589145716, 13.098764109997978, 12.606020958149347, 12.283000393422494, 12.13723967603677, 9.722048424653309, 7.055751847511296, 4.18743854985702, -0.36738385085043657, -4.265598673368434, -7.856599577480475, -10.829543274567143, -14.257710673345384, -15.444338305891641, -17.465985367627923, -18.56370741219783, -20.106679160417684, -20.91617608989479, -21.065388487720316, -19.947915601987813, -17.97163456961223, -16.509168958867463, -14.696448565034316, -10.805522123215049, -6.946419718567901, -3.986816794759156, -0.32659511110960593, 2.148588924842186, 3.5544244175729918, 3.7406077469680348, 3.337776274491778, 2.9970175484572326, 4.285551218975309, 6.03691901109132, 7.713100236104837, 9.965439031380578, 12.040948010683973, 13.047151975841482, 13.542548328443411, 14.06082995104979, 14.381461307195716, 12.052888663495953, 7.860558433541756, 3.4644044125781885, -0.4392731043449607, -4.327383311327109, -7.026110215421189, -11.229913846120256, -13.206951885831336, -14.53335711166906, -16.400914692234732, -18.810921644085155, -20.94805848089234, -22.774192625258667, -24.26487129257237, -24.46786779408164, -24.071243164570717, -21.793930978302214, -18.959190873182067, -15.66838431659593, -11.812148607694036, -9.801497365467933, -6.242596193365631, -4.901196934076104, -3.433503976123342, -2.6068022876570125, -1.7006490501355733, 0.12334286764948788, 2.5383223018069447, 6.201967838630363, 9.314897815263524, 10.69996329714133, 13.139821537933845, 14.663913374875296, 15.866597038534138, 13.62117921851082, 10.843752414134592, 6.936637144471579, 3.9272902487273296, 0.6659838746897324, -3.153828535032229, -6.731204171351246, -10.42937070585813, -13.59792073493359, -17.311333271691403, -20.66000930024179, -21.917234746501652, -24.592454378638294, -26.499054703954606, -29.42299735656742, -28.68152537093593, -27.442185393761477, -26.249222670135243, -23.4016392171422, -20.201825514307792, -16.991757589175457, -13.217278738810135, -8.318748512760502, -4.0483041792791425, 0.09654886001596963, 3.316673768470238, 4.841192787742714, 6.239167182190007, 6.288944856591643, 7.510676292923945, 7.343717641599433, 6.696326989606752, 7.644813238575531, 8.6646407645872, 9.175618882156806, 10.112316877111295, 10.591170659761207, 10.499216082284379, 10.514511679538254, 10.512656574425026, 9.62766995284307, 7.557712655831771, 3.692776074650492, -0.3474778057680552, -3.656267469652468, -6.690214984856242, -8.944767846566396, -10.603816010070135, -13.01254133347512, -15.064370311949686, -17.523782357989916, -17.139524412360647, -16.51479645553239, -15.529267388069844, -14.058630821273258, -13.207114075040266, -12.009039338215603, -10.806377848869666, -9.524831466671932, -8.96721303612981, -7.747722118834501, -5.370176441563409, -3.5777411401144903, -1.9104675149354517, -0.15595386867778183, 2.37257991729943, 3.8024697405112464, 4.399943060276085, 4.532200216065623, 3.449161497981734, 3.419805043300276, 3.6855547591644853, 3.3552926203652134, 4.129753043786817, 5.891203099279843, 8.190323906340417, 9.195117387576678, 9.857572903234097, 10.780753424949683, 9.714293156399776, 8.077590553865697, 4.984578710008384, 2.381347293165427, -1.1121643805424464, -4.931070477433161, -8.211214083274001, -12.067323709119886, -14.042565264754394, -16.374622588756107, -17.383763898974685, -17.665304640559178, -16.154398091131704, -15.593123475170538, -14.56225112040397, -13.061781026831905, -11.091713194454343, -8.652047623271287, -5.742784313282733, -2.363923264488684]

# sliding window for ground truth tailbeats
def calculate_ground_truth_tailbeats(ground_truth_pairs, start, end, window_size=120, step_size=15, fps=30): 
    expected_tailbeats = []

    for s in range(start, end - window_size + 1, step_size):
        e = s + window_size
        count = 0 # count ground truth tailbeats in the window
        for pair in ground_truth_pairs:
            if pair[0] >= s and pair[1] <= e:
                count += 1
            elif pair[0] < s and pair[1] > s:
                count += (pair[1] - s)/(pair[1] - pair[0])
            elif pair[0] < e and pair[1] > e:
                count += (e - pair[0])/(pair[1] - pair[0])
        expected_tailbeats.append(count * fps/window_size) #convert to Hz 

    return expected_tailbeats

# define window and step sizes
crossing_pairs_ns = [(2632, 2667), (2667, 2710), (2710, 2746), (2746, 2782), (2782, 2822), (2822, 2854), (2854, 2895)]
crossing_pairs_b = [(9, 60), (60, 104), (104, 150), (150, 188), (188, 225), (225, 265), (265, 301), (301, 337), (337, 368), (368, 408), (408, 440), (440, 481), (481, 521)]
crossing_pairs_w = [(33, 97), (97, 163), (163, 236), (236, 300), (300, 365), (365, 432), (432, 499), (499, 564), (564, 630), (630, 688), (688, 748)]

ground_truth_pairs_ns = [(2631, 2666), (2666, 2712), (2712, 2748), (2748, 2785), (2785, 2821), (2821, 2859), (2859, 2894)]
ground_truth_pairs_b = [(9, 58), (58, 103), (103, 148), (148, 188), (188, 226), (226, 265), (265, 301), (301, 335), (335, 368), (368, 406), (406, 440), (440, 482), (482, 522)]
ground_truth_pairs_w = [(38, 98), (98, 163), (163, 234), (234, 301), (301, 365), (365, 432), (432, 498), (498, 559), (559, 623), (623, 687), (687, 751)]

# get times when TBF is sampled
predicted_intercross_frames_ns = [pair[1]-pair[0] for pair in crossing_pairs_ns]
predicted_intercross_frames_b = [pair[1]-pair[0] for pair in crossing_pairs_b]
predicted_intercross_frames_w = [pair[1]-pair[0] for pair in crossing_pairs_w]
gt_intercross_frames_ns = [pair[1]-pair[0] for pair in ground_truth_pairs_ns]
gt_intercross_frames_b = [pair[1]-pair[0] for pair in ground_truth_pairs_b]
gt_intercross_frames_w = [pair[1]-pair[0] for pair in ground_truth_pairs_w]


# for frequencies (bottom graph)
actual_tailbeats_ns = calculate_ground_truth_tailbeats(crossing_pairs_ns, start=2631, end=2895)
actual_tailbeats_b = calculate_ground_truth_tailbeats(crossing_pairs_b, start=9, end=522)
actual_tailbeats_w = calculate_ground_truth_tailbeats(crossing_pairs_w, start=33, end=751)

expected_tailbeats_ns = calculate_ground_truth_tailbeats(ground_truth_pairs_ns, start=2631, end=2895)
expected_tailbeats_b = calculate_ground_truth_tailbeats(ground_truth_pairs_b, start=9, end=522)
expected_tailbeats_w = calculate_ground_truth_tailbeats(ground_truth_pairs_w, start=33, end=751)

print(max(actual_tailbeats_b))

####### displacement (top graph) range  ###########
nurse_displacement = {"start": 2620, "end":2930, "buffer":2550}
white_displacement = {"start": 0, "end":752, "buffer": 0}
blacktip_displacement = {"start": 0, "end":555, "buffer": 0}
############ frequencies (bottom graph) range ################
nurse_freq = {"start": 2631, "end":2895}
white_freq = {"start": 33, "end":751}
blacktip_freq = {"start": 9, "end":522}

# frequencies should start after displacement
fps = 30
nurse = 2895-2631
blacktip = 522-9
white = 751-33
print("tailbeats range")
print(f'nurse shark freq length {nurse/fps} seconds')
print(f'blacktip shark freq length {blacktip/fps} seconds')
print(f'white shark freq length {white/fps} seconds')

print("\n")
print("tailbeats data")
print(f'nurse shark freq length {len(actual_tailbeats_ns)} seconds')
print(f'blacktip shark freq length {len(actual_tailbeats_b)} seconds')
print(f'white shark freq length {len(actual_tailbeats_w)} seconds')

# convert to meters
nurse_raw = [pixels_to_meters(dist) for dist in nurse_raw_pix]
white_raw = [pixels_to_meters(dist, altitude=57) for dist in white_raw_pix]
blacktip_raw = [pixels_to_meters(dist, altitude=10) for dist in blacktip_raw_pix]
nurse_smooth = [pixels_to_meters(dist) for dist in nurse_smooth_pix]
white_smooth = [pixels_to_meters(dist, altitude=57) for dist in white_smooth_pix]
blacktip_smooth = [pixels_to_meters(dist, altitude=10) for dist in blacktip_smooth_pix]

print("\n")
print("displacements range")
print(f'nurse shark displacement length {(nurse_displacement['end'] - nurse_displacement['start'])/fps} seconds')
print(f'blacktip shark displacement length {(blacktip_displacement['end'] - blacktip_displacement['start'])/fps} seconds')
print(f'white shark displacement length {(white_displacement['end'] - white_displacement['start'])/fps} seconds')

print("\n")
print("displacements data")
print(f'nurse shark displacement length {len(nurse_smooth)/fps} seconds')
print(f'blacktip shark displacement length {len(blacktip_smooth)/fps} seconds')
print(f'white shark displacement length {len(white_smooth)/fps} seconds')

# define time axis
time_nurse = [x / fps for x in range(len(nurse_smooth))]
time_white = [x / fps for x in range(len(white_smooth))]
time_blacktip = [x / fps for x in range(len(blacktip_smooth))]


# define colors
palette = sns.color_palette("deep", n_colors=10)  # get 3 colors from the "deep" palette
blue = palette[0]
green = palette[2]
red = palette[3]
purple = palette[4]
colors = {
    "White Shark": red,  
    "Nurse Shark": purple, 
    "Blacktip Reef Shark": green, 
}

# plot it all together
import matplotlib.pyplot as plt
import numpy as np

# create the figure with subplots
fig, axs = plt.subplots(4, 1, figsize=(15, 10), gridspec_kw={'height_ratios': [1, 1, 1, 2]}, sharex=True)

# top 3 subplots (tail displacement)
# white Shark
axs[0].plot(np.linspace(-0.5, 41, 100), np.zeros(100), linestyle='--', color='grey')
axs[0].plot(time_white, white_raw, color='grey', linewidth=0.5)
axs[0].plot(time_white, white_smooth, color=colors["White Shark"], linewidth=2)
axs[0].grid(False)
axs[0].set_ylim(-1.4, 1.4)
axs[0].yaxis.set_major_formatter(FormatStrFormatter('%.1f'))
axs[0].set_yticklabels(axs[0].get_yticks(), fontsize=12)

# nurse shark
axs[1].plot(np.linspace(-0.5, 41, 100), np.zeros(100), linestyle='--', color='grey')
axs[1].plot(time_nurse, nurse_raw, color='grey', linewidth=0.5)
axs[1].plot(time_nurse, nurse_smooth, color=colors["Nurse Shark"], linewidth=2)
axs[1].grid(False)
axs[1].set_ylim(-0.3, 0.3)
axs[1].set_ylabel("Tail displacement from body centerline (m)", fontsize=18)
axs[1].set_yticklabels(axs[1].get_yticks(), fontsize=12)
axs[1].yaxis.set_major_formatter(FormatStrFormatter('%.1f'))

# blacktip reef shark
axs[2].plot(np.linspace(-0.5, 41, 100), np.zeros(100), linestyle='--', color='grey')
axs[2].plot(time_blacktip, blacktip_raw, color='grey', linewidth=0.5)
axs[2].plot(time_blacktip, blacktip_smooth, color=colors["Blacktip Reef Shark"], linewidth=2)
axs[2].grid(False)
axs[2].set_ylim(-0.4, 0.4)
axs[2].set_yticklabels(axs[2].get_yticks(), fontsize=12)
axs[2].yaxis.set_major_formatter(FormatStrFormatter('%.1f'))

# bottom subplot (tailbeat frequency)
axs[3].plot([(x + (white_freq['start'] - white_displacement['start'])/fps)/2 + 2.5 for x in range(len(actual_tailbeats_w))], actual_tailbeats_w, color=colors["White Shark"], marker="^", linestyle="--", label='White Shark - Manual')

axs[3].plot([(x + (white_freq['start'] - white_displacement['start'])/fps)/2 + 2.5 for x in range(len(actual_tailbeats_w))], expected_tailbeats_w, color=colors["White Shark"], marker="s", linestyle="-", label='White Shark - FLAIR')

axs[3].plot([(x + (nurse_freq['start'] - nurse_displacement['start'])/fps)/2 + 2.5 for x in range(len(actual_tailbeats_ns))], actual_tailbeats_ns, color=colors["Nurse Shark"], marker="^", linestyle="--", label='Nurse Shark - Manual')

axs[3].plot([(x + (nurse_freq['start'] - nurse_displacement['start'])/fps)/2 + 2.5 for x in range(len(actual_tailbeats_ns))], expected_tailbeats_ns, color=colors["Nurse Shark"], marker="s", linestyle="-", label='Nurse Shark - FLAIR')

axs[3].plot([(x + (blacktip_freq['start'] - blacktip_displacement['start'])/fps)/2 + 2.5 for x in range(len(actual_tailbeats_b))], actual_tailbeats_b, color=colors["Blacktip Reef Shark"], marker="^", linestyle="--", label='Blacktip Reef Shark - Manual')

axs[3].plot([(x + (blacktip_freq['start'] - blacktip_displacement['start'])/fps)/2 + 2.5 for x in range(len(actual_tailbeats_b))], expected_tailbeats_b, color=colors["Blacktip Reef Shark"], marker="s", linestyle="-", label='Blacktip Reef Shark - FLAIR')

axs[3].grid(False)
axs[3].set_ylim(0.4, 0.9)
axs[3].set_xlim(0, 25)
axs[3].set_xlabel("Time (s)", fontsize=18)
axs[3].set_ylabel("Tailbeat frequency (Hz)", fontsize=18)

axs[3].legend(fontsize=18, loc="upper right")
axs[3].set_yticklabels(axs[3].get_yticks(), fontsize=12)
axs[3].yaxis.set_major_formatter(FormatStrFormatter('%.1f'))
axs[3].set_xticklabels(axs[3].get_xticks(), fontsize=12)
axs[3].xaxis.set_major_formatter(FormatStrFormatter('%.0f'))

plt.tight_layout()
plt.savefig("figures/combined_tbf.png", dpi=600, bbox_inches='tight')
plt.show()


# calculate and print mean  SD for each array
print("\n")
print(f"Blacktip (Actual) Mean  SD = {np.mean(actual_tailbeats_b):.2f}  {np.std(actual_tailbeats_b):.2f} Hz")
print(f"Blacktip (Predicted) Mean  SD = {np.mean(expected_tailbeats_b):.2f}  {np.std(expected_tailbeats_b):.2f} Hz")

print(f"White Shark (Actual) Mean  SD = {np.mean(actual_tailbeats_w):.2f}  {np.std(actual_tailbeats_w):.2f} Hz")
print(f"White Shark (Predicted) Mean  SD = {np.mean(expected_tailbeats_w):.2f}  {np.std(expected_tailbeats_w):.2f} Hz")

print(f"Nurse Shark (Actual) Mean  SD = {np.mean(actual_tailbeats_ns):.2f}  {np.std(actual_tailbeats_ns):.2f} Hz")
print(f"Nurse Shark (Predicted) Mean  SD = {np.mean(expected_tailbeats_w):.2f}  {np.std(expected_tailbeats_w):.2f} Hz")

percent_error_white = percent_error(actual_tailbeats_w, expected_tailbeats_w)
percent_error_nurse = percent_error(actual_tailbeats_ns, expected_tailbeats_ns)
percent_error_blacktip = percent_error(actual_tailbeats_b, expected_tailbeats_b)
percent_errors = np.concatenate([percent_error_white, percent_error_nurse, percent_error_nurse])

print("\n")
print(f'White Shark Mean percent error  SD: {np.mean(percent_error_white):.2f}  {np.std(percent_error_white):.2f} %')
print(f'Nurse Shark Mean percent error  SD: {np.mean(percent_error_nurse):.2f}  {np.std(percent_error_nurse):.2f} %')
print(f'Blacktip Shark Mean percent error  SD: {np.mean(percent_error_blacktip):.2f}  {np.std(percent_error_blacktip):.2f} %')

print("\n")
print(f'White Shark percent error min: {np.min(percent_error_white):.2f} %, max: {np.max(percent_error_white):.2f} %, n = {len(percent_error_white)}')
print(f'Nurse Shark percent error min: {np.min(percent_error_nurse):.2f} %, max: {np.max(percent_error_nurse):.2f} %, n = {len(percent_error_nurse)}')
print(f'Blacktip Shark percent error min: {np.min(percent_error_blacktip):.2f} %, max: {np.max(percent_error_blacktip):.2f} %, n = {len(percent_error_blacktip)}')

print("\n")
print(f'Overall Mean percent error  SD: {np.mean(percent_errors):.2f}  {np.std(percent_errors):.2f} %')
print(f'Overall percent error min: {np.min(percent_errors):.2f} %, max: {np.max(percent_errors):.2f} %, n = {percent_errors.shape[0]}')

print('\n')
print(f'White shark mean  mean absolute error: {np.mean(actual_tailbeats_w):.2f}  {mean_absolute_error(actual_tailbeats_w, expected_tailbeats_w):.2f} Hz')
print(f'Nurse shark mean  mean absolute error: {np.mean(actual_tailbeats_ns):.2f}  {mean_absolute_error(actual_tailbeats_ns, expected_tailbeats_ns):.2f} Hz')
print(f'Blacktip shark mean  mean absolute error: {np.mean(actual_tailbeats_b):.2f}  {mean_absolute_error(actual_tailbeats_b, expected_tailbeats_b):.2f} Hz')

